# 基金筛选功能实现方案

## 需求概述

- **应用场景**：网页端 + 移动端适配，支持微信/企业微信消息推送
- **技术栈**：Python (FastAPI) + Vue3 + PostgreSQL
- **目标基金**：收益稳定、风险可控的量化基金
- **展示方式**：图表结合 + 卡片式展示

---

## 技术栈推荐

| 层级 | 技术选型 | 理由 |
|------|---------|------|
| **后端框架** | FastAPI + SQLAlchemy | Python生态性能最好，自动生成API文档 |
| **前端框架** | Vue3 + TypeScript + Vant | 移动端适配优秀，组件丰富 |
| **数据库** | PostgreSQL + Redis | 支持JSON字段，Redis缓存热点数据 |
| **数据源** | AKShare + 天天基金网 | 免费且Python原生支持 |
| **图表库** | ECharts | Python端(PyEcharts)和前端都能用 |
| **消息推送** | 企业微信机器人 + 微信服务号 | 企业微信最简单，微信需要认证 |

---

## 核心筛选维度

### 量化基金识别指标
- **基金名称关键词**：量化、多因子、AI策略、算法、机器学习、指数增强
- **策略标签**：主动量化、被动量化（指数增强型）

### 收益稳定性指标
- **夏普比率** > 1.0（风险调整后收益）
- **卡玛比率** > 2.0（收益/最大回撤）
- **收益标准差** < 15%（年化波动小）
- **月度胜率** > 60%（每月正收益概率）

### 风险可控指标
- **最大回撤** < 20%（历史最大亏损）
- **下行风险** < 10%（下跌波动率）
- **Beta系数** < 1.0（相对大盘波动小）

---

## 实现步骤

### 第一阶段：基础架构搭建（1-2周）

#### 1. 项目初始化
- 创建FastAPI项目结构（models, schemas, crud, api, services）
- 配置PostgreSQL数据库连接
- 搭建Vue3 + Vant移动端响应式框架
- 配置Redis缓存

#### 2. 数据采集模块
- 接入AKShare获取基金基础信息（基金代码、名称、类型、经理）
- 编写定时任务每日抓取净值数据（APScheduler）
- 基金分类标签自动化（识别量化基金）

#### 3. 核心数据表设计
```sql
funds - 基金基础信息表
fund_nav - 每日净值表
fund_metrics - 风险指标计算表（周更新）
fund_tags - 基金标签表（量化、稳健等）
user_alerts - 用户提醒配置表
```

---

### 第二阶段：筛选与计算引擎（2-3周）

#### 4. 指标计算服务
- 编写Python函数计算夏普比率、最大回撤、波动率
- 实现滚动窗口计算（近1年、近3年指标）
- 量化基金打分算法（多因子加权评分）

#### 5. 筛选API开发
- 多条件组合筛选接口（类型+指标范围+排序）
- 高级筛选：自定义指标阈值
- 筛选结果缓存优化（热门条件缓存1小时）

#### 6. 预警规则引擎
- 用户可设置净值提醒（涨跌幅度）
- 风险指标异动提醒（回撤超过阈值）
- 新基金入库提醒（符合筛选条件的基金）

---

### 第三阶段：前端可视化（2周）

#### 7. 基金卡片组件
- 展示：基金名称、类型标签、近1年收益、夏普比率、最大回撤
- 风险评级徽章（绿色-稳健、黄色-中等、红色-激进）
- 一键对比功能（最多选4只基金）

#### 8. 图表可视化
- 收益走势图（近1年/3年）
- 风险收益散点图（横轴-波动率，纵轴-收益率）
- 指标雷达图（收益、风险、稳定性多维度）

#### 9. 移动端适配
- 底部筛选栏（抽屉式展开）
- 下拉刷新、上拉加载
- 横屏图表适配

---

### 第四阶段：消息推送系统（1周）

#### 10. 企业微信集成
- 配置企业微信机器人Webhook
- 编写消息模板（筛选结果日报、预警通知）
- 用户绑定企业微信ID

#### 11. 微信服务号（可选升级）
- 申请微信服务号（需要企业资质）
- 实现模板消息推送
- 网页授权登录

---

### 第五阶段：部署与优化（1周）

#### 12. 部署上线
- Docker容器化部署（后端+前端+数据库）
- Nginx反向代理配置
- 定时任务部署（每日收盘后更新数据）

#### 13. 性能优化
- 数据库索引优化（基金代码、日期字段）
- 分页查询优化（游标分页）
- CDN加速静态资源

---

## 项目文件结构

```
fund-screener/
├── backend/
│   ├── app/
│   │   ├── api/          # API路由
│   │   ├── core/         # 配置、安全
│   │   ├── crud/         # 数据库操作
│   │   ├── models/       # SQLAlchemy模型
│   │   ├── schemas/      # Pydantic模型
│   │   ├── services/     # 业务逻辑（计算指标）
│   │   └── tasks/        # 定时任务
│   ├── alembic/          # 数据库迁移
│   └── requirements.txt
├── frontend/
│   ├── src/
│   │   ├── api/          # API请求
│   │   ├── components/   # 组件
│   │   │   ├── FundCard.vue
│   │   │   ├── FilterPanel.vue
│   │   │   └── Charts/
│   │   ├── views/        # 页面
│   │   └── stores/       # Pinia状态管理
│   └── package.json
└── docker-compose.yml
```

---

## 待确认问题

1. **数据实时性**：基金净值每天收盘后更新，你能接受T+1的数据延迟吗？还是需要接入实时估值API？

2. **用户系统**：需要用户登录注册功能吗？还是纯公开查询？（涉及收藏、提醒等个性化功能）

3. **预算范围**：如果基金数量较大（5000+只），是否需要考虑服务器成本？（建议初期筛选范围缩小到量化基金）

4. **企微通知**：你有企业微信的机器人权限吗？还是需要我提供申请步骤？

---

## 预计开发周期

- **总计**：7-9周（1.5-2个月）
- **MVP版本**：4-5周（基础筛选+简单图表）
- **完整版本**：7-9周（含消息推送+高级图表）

---

*创建日期：2026-02-14*
